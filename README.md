## æœ¬é¡¹ç›®æ˜¯åŸºäºBERT-VITSçš„éŸ³è‰²å…‹éš†ï¼ˆå¾®è°ƒï¼‰
### æœ¬åˆ†æ”¯ä¸éœ€è¦auxiliary dataï¼Œæä¾›20æ¡ï½40æ¡5séŸ³é¢‘æ•°æ®ï¼Œè®­ç»ƒ40minå·¦å³å°±å¯ä»¥å¾—åˆ°ä¸é”™çš„éŸ³è‰²å…‹éš†æ•ˆæœã€‚å»ºè®®å½•éŸ³æ—¶æ”¾æ…¢è¯­é€Ÿã€‚

```
- bert_vits.json ä¸­ï¼Œ"n_speakers" æ”¹ä¸º 0 ï¼Œ"gin_channels" æ”¹ä¸º 0ã€‚
- log_intervalå’Œeval_intervalé»˜è®¤çš„å¤ªå¤§äº†ï¼Œåˆ†åˆ«æ”¹ä¸º10å’Œ100ã€‚
- train.pyä¸­ï¼ŒL124è¡Œï¼ŒåŠ å…¥äº†åŠ è½½é¢„è®­ç»ƒæ¨¡å‹çš„ä»£ç ï¼š
- utils.load_model("AISHELL3_G.pth", net_g)
- utils.load_model("AISHELL3_D.pth", net_g)
- æ— æ³•ä½¿ç”¨ Duration Predictor (dp) è¿›è¡Œè®­ç»ƒæˆ–æ¨ç†ï¼Œå› ä¸ºAISHELL3åº•æ¨¡å‹ç”¨çš„å°±æ˜¯ Stochastic Duration Predictor (sdp)ã€‚
```

## ä½¿ç”¨è¯¥ç¬”è®°æœ¬åœ¨Colabä¸Šè¿›è¡Œæµ‹è¯•ï¼š[BERT_vits_without_auxiliary(new)](https://github.com/luuumity/vits_chinese/blob/bert_vits_aishell3/BERT_vits_without_auxiliary(new).ipynb)
## ç”Ÿæˆçš„éŸ³é¢‘æ ·ä¾‹ï¼š[ğŸ“Attached Audios](https://valuable-odometer-38c.notion.site/Attached-Audios-ce736be5be6c46cc951b635d6d81c004?pvs=4)
<br></br>

## ä¸€äº›æ³¨æ„äº‹é¡¹ï¼š

### ä¸€ã€å…³äºæ•°æ®é¢„å¤„ç†ï¼š

#### 0.è‡ªå·±çš„å¾®è°ƒæ•°æ®é›†æ”¾åœ¨ data/xxx/ ä¸­ï¼ˆxxxä¸ºè§’è‰²åï¼Œæˆ‘è¿™é‡Œæ˜¯SJYï¼‰
#### 0.é¢„å¤„ç†å‰åº”å…ˆæ‰‹åŠ¨åˆ›å»º vits_data/ ç›®å½•

#### 1.é‡é‡‡æ ·ï¼šç›®çš„æ˜¯é‡é‡‡æ ·è‡³16kHzã€‚

#### 2.æ‹¼éŸ³æ ‡æ³¨åŠæ ¼å¼è§„èŒƒåŒ–

- åŸå§‹æ–‡æœ¬è¯·æ”¾åœ¨input.txtï¼Œé»˜è®¤è¾“å‡ºåˆ°vits_data/labels.txtã€‚

- åŸå§‹æ–‡æœ¬æ ·å¼ï¼ˆinput.txtï¼‰ï¼š â€è§’è‰²å(ä»…å«å­—æ¯) æ•°å­— .wav  å†…å®¹(å¯å«æ ‡ç‚¹ç¬¦å·)â€œ
```
SJY001.wav ä¸€å¸†é£é¡ºè™½ç„¶ä»¤äººç¾¡æ…•ï¼Œå¯æ˜¯æœ‰çš„æ—¶å€™é€†æ°´è¡ŒèˆŸæ›´è®©äººé’¦ä½©ã€‚
SJY002.wav æˆ‘ä»¬å¿…é¡»ä¸å…¶ä»–ç”Ÿç‰©å…±åŒåˆ†äº«æˆ‘ä»¬çš„åœ°çƒã€‚
```
- æ‹¼éŸ³æ ‡æ³¨å’Œè§„èŒƒåŒ–åçš„æ ·å¼ï¼ˆlabels.txtï¼‰
```
SJY001.wav ä¸€å¸†é£é¡ºè™½ç„¶ä»¤äººç¾¡æ…•ï¼Œå¯æ˜¯æœ‰çš„æ—¶å€™é€†æ°´è¡ŒèˆŸæ›´è®©äººé’¦ä½©ã€‚
	yi1 fan2 feng1 shun4 sui1 ran2 ling4 ren2 xian4 mu4 ke3 shi4 you3 de5 shi2 hou4 ni4 shui3 xing2 zhou1 geng4 rang4 ren2 qin1 pei4
SJY002.wav æˆ‘ä»¬å¿…é¡»ä¸å…¶ä»–ç”Ÿç‰©å…±åŒåˆ†äº«æˆ‘ä»¬çš„åœ°çƒã€‚
	wo3 men5 bi4 xu1 yu3 qi2 ta1 sheng1 wu4 gong4 tong2 fen1 xiang3 wo3 men5 de5 di4 qiu2
```
#### 3.ä½¿ç”¨berté¢„å¤„ç†
- é»˜è®¤å‰1/5çš„æ•°æ®ä½œä¸º valid é›†ï¼Œå4/5çš„æ•°æ®ä½œä¸º train é›†ã€‚

- ä¼šæ‰“å°å¹¶è¿‡æ»¤æ•°æ®ä¸­æœ¬é¡¹ç›®ä¸æ”¯æŒçš„**å„¿åŒ–éŸ³**æ¡ç›®

- filelistsä¸­çš„æ ¼å¼ï¼š
```
æˆ‘çš„æ•°æ®é›†ä¼šç”Ÿæˆè¿™æ ·çš„ï¼š
1|vits_data/waves-16k/SJY/SJY001.wav|vits_data/temps/SJY/SJY001.spec.pt|vits_data/berts/SJY/SJY001.wav.npy|sil ^ i1 f an2 f eng1 sh uen4 s uei1 r an2 l ing4 r en2 x ian4 m u4 sp k e3 sh iii4 ^ iou3 d e5 sh iii2 h ou4 n i4 sh uei3 x ing2 zh ou1 g eng4 r ang4 r en2 q in1 p ei4 sp sil
1|vits_data/waves-16k/SJY/SJY002.wav|vits_data/temps/SJY/SJY002.spec.pt|vits_data/berts/SJY/SJY002.wav.npy|sil ^ uo3 m en5 b i4 x v1 ^ v3 q i2 t a1 sh eng1 ^ u4 g ong4 t ong2 f en1 x iang3 ^ uo3 m en5 d e5 d i4 q iou2 sp sil
```

#### 4.å¾ªç¯å¤åˆ¶trainçš„æ¡ç›®ï¼Œç›´åˆ°>800æ¡ã€‚ä¸ºäº†åŠ å¤§æ¯epochä¸­çš„æ•°æ®æ•°é‡ï¼Œé¿å…é¢‘ç¹è¯»å†™ã€‚

#### 5.æ•°æ®è¯»å–æµ‹è¯•ã€‚

### äºŒã€å…³äºè®­ç»ƒï¼š
1.æ¯ä¸ªçŸ­è¯­/å­—çš„**å°¾éŸ³é—®é¢˜**æ˜æ˜¾è·Ÿåº•æ¨¡å‹æœ‰å…³ï¼Œåº•æ¨¡å‹å°¾éŸ³å°±æœ‰æ˜æ˜¾é—®é¢˜ï¼Œæˆ‘å…‹éš†åè¿˜å¥½äº†ç‚¹ã€‚ã€‚ã€‚  

2.è™½è¯´åœ¨BERT-VITSä¸­ä½¿ç”¨Duration Predictorï¼ˆdpï¼‰ä¼¼ä¹æ•ˆæœä¼šæ›´å¥½ï¼Œä½†æœ¬é¡¹ç›®**æ— æ³•ä½¿ç”¨ Duration Predictorï¼ˆdpï¼‰**ï¼Œå› ä¸ºAISHELL3é¢„è®­ç»ƒæ¨¡å‹**ç”¨çš„å°±æ˜¯ Scholastic Duration Predictorï¼ˆsdpï¼‰**ã€‚å¦‚æœå¾®è°ƒæ—¶æƒ³ç”¨dpï¼ŒåŠ è½½åº•æ¨¡å‹æƒé‡æ—¶ä¼šæŠ¥é”™ã€‚  

3.å¾®è°ƒçš„æœ¬è´¨å°±æ˜¯åŠ è½½é¢„è®­ç»ƒæ¨¡å‹ï¼Œç”¨å®ƒçš„æƒé‡ä¸ºè‡ªå·±çš„å„ä¸ªå±‚åˆå§‹åŒ–ï¼Œç„¶åå†ï¼ˆé€šå¸¸ï¼‰åœ¨å¦ä¸€ä¸ªæ•°æ®é›†ä¸Šç»§ç»­è®­ç»ƒã€‚  
æ‰€ä»¥ç”¨ä¸€ä¸ªä¸æ˜¯åœ¨BERT-VITSæ¶æ„ä¸Šè®­ç»ƒçš„é¢„è®­ç»ƒVITSæ¨¡å‹ä¹Ÿæ˜¯å¯ä»¥å¾®è°ƒçš„ï¼Œåªæ˜¯éœ€è¦æ‰‹åŠ¨åˆå§‹åŒ–ä¸€ä¸‹è¿æ¥å¤„çš„çº¿æ€§å±‚ä¹‹ç±»çš„ï¼Œå¯èƒ½è¦æ”¹ä»£ç ï¼Œè€Œä¸”æ”¶æ•›å¯èƒ½æ…¢ä¸€ç‚¹ï¼ˆæ¯•ç«Ÿè¦æ–°å­¦ä¸€ä¸¤å±‚ï¼‰ã€‚  
ï¼ˆä¸è¿‡ç”¨AISHELL3åº•æ¨¡å‹çš„è¯ä¸ç”¨æ”¹ï¼Œå› ä¸ºé‚£æœ¬æ¥å°±æ˜¯åœ¨BERT-VITSæ¶æ„ä¸Šè®­ç»ƒçš„åº•æ¨¡å‹ï¼‰  
ï¼ˆåŒç†ï¼Œå¦‚æœä½ èƒ½å¤Ÿæ‰‹åŠ¨åˆå§‹åŒ–dpçš„ä»£ç ï¼Œä¹Ÿæ˜¯å¯ä»¥ç”¨AISHELL3å¾®è°ƒçš„ï¼Œå°±ç›¸å½“äºä»AISHELL3å–éœ€è¦çš„æƒé‡ï¼Œå†æŠŠä¸éœ€è¦çš„sdpæƒé‡æ‰”æ‰â€¦â€¦â€”â€”å…¶å®è¿™å°±å·²ç»æ˜¯åœ¨å¤„ç†2ä¸ªä¸åŒå½¢çŠ¶çš„æ¨¡å‹äº†ï¼‰

### ä¸‰ã€å…³äºæ¨ç†ï¼š
1.å¯ä»¥ä¿®æ”¹ length_scaleã€noise_scale_wã€noise_scale å‚æ•°æ§åˆ¶ç”Ÿæˆçš„éŸ³é¢‘æ€»è¯­é€Ÿã€å•ä¸ªéŸ³ç´ è¯­é€Ÿã€å˜åŒ–ç­‰ã€‚ï¼ˆsdpçš„ç‰¹æ€§ï¼‰  

2.å¦‚æœå‘ç°æœ‰æ‹¼éŸ³æ ‡æ³¨ä¸æ­£ç¡®çš„ï¼Œè¯·åœ¨ text/pinyin-local.txt ä¸­æ‰‹åŠ¨æ ‡æ³¨ä¸Šæ­£ç¡®çš„è¯»éŸ³ï¼Œå¦‚â€œä¸€å¸†é£é¡º yi1 fan1 feng1 shun4â€ã€â€œä¼¼ si4â€ï¼Œä¹Ÿå¯ä»¥æ ‡æ³¨ä¸€äº›å¸¸ç”¨è½»å£°çš„ï¼Œå¦‚â€œç¾¡æ…• xian4 mu5â€ã€‚  

3.å¦‚æœæƒ³è¦çœ‹çœ‹æ²¡æœ‰BERTæ˜¯ä»€ä¹ˆæ ·å­ï¼Œä½¿ç”¨vits_infer_no_bert.pyæ¨ç†å³å¯ã€‚  
æµ‹è¯•çš„æ„Ÿè§‰æ˜¯ï¼š  
no BERTç¡®å®æ›´æ£’è¯»ä¸€äº›ï¼ˆ**é‡éŸ³**å’Œ**è¯­é€Ÿ**éƒ½å¾ˆ**å¹³å‡**ï¼Œè€Œä¸”**åå¿«**ï¼‰ï¼Œåœ¨çŸ­å¥å’Œè¯—å¥ä¸Šå¯èƒ½ä¸æ˜æ˜¾ï¼Œä½†åœ¨é•¿å¥ä¸Šå¾ˆæ˜æ˜¾ã€‚  
æœ‰BERTåˆ™æ›´ç¬¦åˆäººçš„**è¿è¯»ä¹ æƒ¯**ï¼Œä¼šæœ‰æ ¹æ®**è¯­ä¹‰**è€Œå®šçš„**åœé¡¿**/åˆ†è¯ï¼Œä¹Ÿä¼šæœ‰**åŠ é€Ÿå’Œå‡é€Ÿ**ï¼Œ**è€Œéä¸€ç›´åŒ€é€Ÿ**ã€‚  
è¿™å¯èƒ½è¦å½’åŠŸäºBERT_Prosody Modelå­¦ä¹ åˆ°çš„å¯¹prosody labelçš„é¢„æµ‹ï¼ˆæ ‡ç‚¹->2ï¼ŒçŸ­è¯­/è¯->0111...ï¼‰ï¼Œ0111...è¿™ç§æ ‡æ³¨æ³•å¯èƒ½ç¡®å®ä¼šå¸¦æœ‰å˜é€Ÿè¿‡æ¸¡çš„ä¿¡æ¯ï¼Ÿã€‚
